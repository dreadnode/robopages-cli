description: Metasploit is an open-source penetrating framework used by security engineers as a penetration testing system and a development platform that allows to create security tools and exploits.
# https://www.offsec.com/metasploit-unleashed/

functions:
  msf_smb_login:
    description: SMB Login Check Scanner can be very useful, as it will connect to a range of hosts and determine if the username/password combination can access the target.
    parameters:
      auxillary:
        type: string
        description: The auxillary loaded within the MetaSploit framework.
        examples:
          - smb_login
      target:
        type: string
        description: RHOSTS.
        examples:
          - 192.168.1.0/24

    container:
      image: metasploitframework/metasploit-framework
      args:
        - --net=host
      volumes:
        - $HOME:/var/metasploit-framework

    cmdline:
      - use auxiliary/scanner/smb/${auxillary}
      - set RHOSTS ${target}
      - set SMBUser victim
      - set SMBPass s3cr3t
      - set THREADS 50
      - run